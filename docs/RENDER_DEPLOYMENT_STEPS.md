# Render.com デプロイ手順（更新版）

## 📋 概要

改善したコードをRender.comにデプロイする手順を説明します。

Render.comは、GitHubリポジトリに変更をプッシュすると自動的にデプロイが開始されます。

---

## 🚀 デプロイ手順（ステップバイステップ）

### ステップ1: 変更を確認

変更したファイルを確認：

```bash
git status
```

今回修正した主要なファイル：
- `frontend/src/pages/DashboardPage.tsx` - エラーハンドリング改善
- `frontend/src/api/axios.ts` - タイムアウト設定追加

### ステップ2: 変更をステージング（追加）

変更したファイルをGitに追加します。

**方法1: 特定のファイルのみ追加（推奨）**
```bash
git add frontend/src/pages/DashboardPage.tsx
git add frontend/src/api/axios.ts
git add docs/本番環境機能確認チェックリスト.md
```

**方法2: 全ての変更を追加**
```bash
git add .
```

⚠️ **注意**: `git add .` を使う場合、意図しないファイルが含まれていないか確認してください。

### ステップ3: コミットメッセージを作成

変更内容を説明するコミットメッセージを書きます：

```bash
git commit -m "fix: ダッシュボードのエラーハンドリング改善

- エラーメッセージを詳細化（どのAPIが失敗したかを表示）
- axiosタイムアウトを30秒に設定（Render無料プランのスリープ対応）
- 各API呼び出しを個別に処理して、部分的な失敗に対応
- 本番環境機能確認チェックリストを追加"
```

### ステップ4: GitHubにプッシュ

変更をGitHubリポジトリにプッシュします：

```bash
git push origin main
```

または、ブランチが `master` の場合は：

```bash
git push origin master
```

⚠️ **ブランチ名の確認**: デプロイガイドでは `master` となっていますが、現在のブランチを確認してください。

### ステップ5: Render.comでデプロイを確認

1. **Render.comダッシュボードにログイン**
   - https://dashboard.render.com/ にアクセス

2. **フロントエンドサービスを確認**
   - 「Static Sites」セクションで `trade-dx-frontend` を選択
   - 「Events」タブでデプロイ状況を確認

3. **デプロイの進行状況**
   - 「Building」→ 「Deploying」→ 「Live」の順に進みます
   - 通常、フロントエンドのデプロイは3-5分程度かかります

4. **デプロイログの確認**
   - 「Logs」タブでビルドログやエラーログを確認できます

---

## 🔍 デプロイ後の確認

### 1. デプロイが成功したか確認

Render.comのダッシュボードで、フロントエンドサービスのステータスが「Live」になっていることを確認してください。

### 2. フロントエンドにアクセス

ブラウザで以下にアクセス：
- `https://trade-dx-frontend.onrender.com`

### 3. ダッシュボードの動作確認

1. ログイン
2. ダッシュボードページを開く
3. エラーメッセージが改善されているか確認
   - より詳細なエラーメッセージが表示されるはずです
   - どのAPIが失敗したかが分かるようになっています

### 4. ブラウザのコンソールで確認

F12キーで開発者ツールを開き、コンソールタブでエラーログを確認してください。

---

## ⚠️ トラブルシューティング

### 問題1: デプロイが失敗する

**原因と対処法**:

1. **ビルドエラー**
   - Render.comの「Logs」タブでエラーログを確認
   - TypeScriptのコンパイルエラーや依存関係の問題がないか確認

2. **ブランチ名の不一致**
   - Render.comの設定でブランチ名が `main` または `master` のどちらになっているか確認
   - 設定を変更するか、プッシュするブランチを変更

### 問題2: デプロイは成功したが、エラーが解消されない

**確認項目**:

1. **ブラウザのキャッシュをクリア**
   - Ctrl+Shift+R（Windows/Linux）または Cmd+Shift+R（Mac）で強制リロード

2. **バージョンを確認**
   - ブラウザの開発者ツール（F12）→ Networkタブ
   - ファイルのタイムスタンプを確認

3. **エラーメッセージを確認**
   - コンソールに表示されるエラーメッセージを確認
   - どのAPIが失敗しているか確認

### 問題3: バックエンドも更新が必要な場合

今回の変更はフロントエンドのみですが、将来的にバックエンドも更新する場合：

1. **バックエンドサービスを確認**
   - Render.comダッシュボードで「Web Services」セクションの `trade-dx-v2` を確認

2. **バックエンドも自動デプロイ**
   - バックエンドのコードを変更してプッシュすると、自動的にデプロイが開始されます
   - デプロイには5-10分程度かかります

---

## 📝 デプロイチェックリスト

デプロイ前：
- [ ] 変更したファイルを確認
- [ ] ローカルで動作確認（オプション）
- [ ] コミットメッセージを作成

デプロイ中：
- [ ] `git add` でファイルを追加
- [ ] `git commit` でコミット
- [ ] `git push` でGitHubにプッシュ
- [ ] Render.comダッシュボードでデプロイ状況を確認

デプロイ後：
- [ ] フロントエンドが正常にアクセスできるか確認
- [ ] ダッシュボードページを開く
- [ ] エラーメッセージが改善されているか確認
- [ ] ブラウザのコンソールでエラーがないか確認

---

## 🔄 今後のデプロイ

今後も同じ手順でデプロイできます：

1. コードを修正
2. `git add` で変更を追加
3. `git commit` でコミット
4. `git push` でGitHubにプッシュ
5. Render.comが自動的にデプロイを開始

---

## 📚 関連ドキュメント

- [Render.com デプロイ手順書](./RENDER_DEPLOYMENT_GUIDE.md)
- [Render.com デプロイチェックリスト](./RENDER_DEPLOYMENT_CHECKLIST.md)
- [本番環境機能確認チェックリスト](./本番環境機能確認チェックリスト.md)

---

**最終更新**: 2025-12-01
