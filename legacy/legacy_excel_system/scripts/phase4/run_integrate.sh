#!/bin/bash
######################################################################
# 統合処理実行スクリプト（Linux/Mac用）
# Phase 4: 項目単位の競合解決とリトライ機構
#
# 【使用方法】
#   ./run_integrate.sh
#
# 【機能】
#   - 各ユーザーファイルからマスターファイルへデータを統合
#   - 項目単位の競合解決（V2.1新機能）
#   - ファイルロック検知とリトライ
#   - 競合ログの自動出力
#
# 【作成日】2025-11-20
######################################################################

echo "======================================================================"
echo "統合処理スクリプト（V2.1 - 改良版）"
echo "Phase 4: 項目単位の競合解決とリトライ機構"
echo "======================================================================"
echo ""

# スクリプトのディレクトリに移動
cd "$(dirname "$0")"

# Python実行
python3 integrate_data.py

# 終了コードをチェック
if [ $? -eq 0 ]; then
    echo ""
    echo "======================================================================"
    echo "✓ 統合処理が正常に完了しました"
    echo "======================================================================"
    exit 0
else
    echo ""
    echo "======================================================================"
    echo "✗ 統合処理が失敗しました"
    echo "  ログファイルを確認してください: ../../logs/"
    echo "======================================================================"
    exit 1
fi


